function [d, discrim] = FitConicToFivePoints(a,b)
syms x y M;
M = [x^2 x*y y^2 x y 1;...
    a(1)^2 a(1)*b(1) b(1)^2 a(1) b(1) 1;...
    a(2)^2 a(2)*b(2) b(2)^2 a(2) b(2) 1;...
    a(3)^2 a(3)*b(3) b(3)^2 a(3) b(3) 1;...
    a(4)^2 a(4)*b(4) b(4)^2 a(4) b(4) 1;...
    a(5)^2 a(5)*b(5) b(5)^2 a(5) b(5) 1];
d=det(M);
% compute discriminant
x2coef = double(det(M(2:end,2:end)));
y2coef = double(det(M(2:end,[1:2 4:end])));
xycoef = - double(det(M(2:end,[1 3:end])));
discrim = xycoef^2-4*x2coef*y2coef; % "b^2-4*a*c"
end